$(document).ready(function($){function e(e){t(e),n(e)}function t(e){for(var t=0;e>t;t++){var n=Math.random().toFixed(1)/1.5,o=$('<li class="avatar__item">');v.append(o),m.push(t)}}function n(){for(;m.length>0;){var e=m[Math.floor(Math.random()*m.length)],t=$(".avatar__item").eq(e),n=m.indexOf(e);m.splice(n,1);var o=$("<img>"),a=Math.floor(Math.random()*h.length);o.attr("src",h[a]),o.bind("load",function(){$(this).fadeIn(300)}),t.html(o)}}function o(e){var t=window.pageYOffset>=g?!0:!1;t&&f.not("stuck")?f.addClass("stuck"):f.removeClass("stuck")}function a(e,t,n,o){var a=void 0!=window.screenLeft?window.screenLeft:screen.left,i=void 0!=window.screenTop?window.screenTop:screen.top,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=r/2-n/2+a,c=l/2-o/2+i,d=window.open(e,t,"scrollbars=yes, width="+n+", height="+o+", top="+c+", left="+s);window.focus&&d.focus()}function i(e,t){var n=encodeURIComponent(e+t),o="https://twitter.com/intent/tweet?text="+n;return o}function r(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"#039;")}function l(e,t,n){var o=localStorage.getItem(e);if(null===o){var a=[];localStorage.setItem(e,JSON.stringify(a)),o=localStorage.getItem(e)}var i=JSON.parse(o),r=i.indexOf(t);if(-1===r){i.push(t),localStorage.setItem(e,JSON.stringify(i));var l=$("#share"+t),s=+l.text();l.text(s+1),$.post(n)}}function s(){w.toggleClass("open"),y.toggleClass("open")}function c(){var e={lines:11,length:4,width:2,radius:5,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:57,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},t=document.getElementById("spinner"),n=new Spinner(e).spin(t)}function d(){var e=$(window).width();e>=768&&$(".menu--open").toggleClass("menu--open");var t=$(window).height(),n=$(".modal__footer").height(),o=t-n-30;$(".figure--image").height(o);var a=$(".modal--video").height(),i=o-a;$(".modal--video").css("margin-top",i/2)}posts.init(all_posts,".tiles"),$(".load-more").on("click",function(){ga("send","event",{eventCategory:"Menu",eventAction:"LoadMorePosts"}),posts.paginate()}),modal.init(),_.isEmpty(redirect)||_.isUndefined(redirect.post)||modal.open(redirect.post,!0);var p=$("#legal").html(),u=Handlebars.compile(p);$("#privacy_policy").on("click",function(e){e.preventDefault(),_.isEmpty(p)?console.log("Need to create a privacy page."):modal.openLegal(u(privacy.post_content))}),$("#legal_notice").on("click",function(e){e.preventDefault(),_.isEmpty(p)?console.log("Need to create a privacy page."):modal.openLegal(u(legal.post_content))}),jQuery.sharedCount=function(e,t){e=encodeURIComponent(e||location.href);var n="//free.sharedcount.com",o="6b33f88e60070f13fad86783368710ac3643e18e",a={data:{url:e,apikey:o},url:n+"/url",cache:!0,dataType:"json"};if("withCredentials"in new XMLHttpRequest)a.success=t;else{var i="sc_"+e.replace(/\W/g,"");window[i]=t,a.jsonpCallback=i,a.dataType+="p"}return jQuery.ajax(a)},$.sharedCount("http://firefox.com",function(e){var t=e.Facebook.total_count+e.GooglePlusOne+e.LinkedIn+e.Pinterest+e.StumbleUpon+e.Twitter,n=numeral(t).format("0,0");$(".mentions__count").text(n)});var v=$(".avatars"),m=[],h=[];$.getJSON(templateUrl+"/data/urls.json",function(t){h=t,e(180)});var f=$(".header--sticky"),g=256;window.onscroll=o,$(".header--sticky h1").on("click",function(){$("html, body").animate({scrollTop:0},500)}),$(".tiles").on("click",".zoom",function(e){var t=$(this).parent(".tiles__item").attr("id").match(/\d+/)[0];modal.open(t),d()}),$(document).on("click",".share__item .icon",function(e){e.preventDefault();var t=$(this),n;n=$(this).parents().siblings(".share__count").length>0?$(this).parents().siblings(".share__count")[0].id.match(/\d+/)[0]:0;var o=posts.getPost(n);if(o.bitly&&(o.bitly=o.bitly.replace(/^http:\/\//i,location.protocol+"//")),t.is(".icon--facebook")){ga("send","event",{eventCategory:"Social",eventAction:"Share",eventLabel:"Facebook",eventValue:o.post_title});var r=t.attr("href"),s="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(r);a(s,"Facebook",550,450),l("facebook",n,o.bitly)}else if(t.is(".icon--twitter")){ga("send","event",{eventCategory:"Social",eventAction:"Share",eventLabel:"Twitter",eventValue:o.post_title});var c=$.parseHTML(o.tweet);console.log(o);var s=i(c[0].data," #FoxYeah - "+o.bitly);a(s,"Tweet",550,450),l("twitter",n,o.bitly)}else t.is(".icon--email")&&(modal.email(o.ID),d(),ga("send","event",{eventCategory:"Social",eventAction:"Share",eventLabel:"Email",eventValue:o.post_title}),l("email",n,o.bitly))});var w=$(".filter__action"),y=$(".filter__options"),b=y.find("li");$(".filter__action").on("click",function(e){e.preventDefault(),s()}),$("body").on("click",function(e){var t=e.target.classList[0];"filter__action"!==t&&y.is(".open")&&s()}),b.on("click",function(){b.removeClass("active");var e=$(this);e.addClass("active");var t=e.text();w.text(t),posts.sortBy(this.dataset.sortBy),ga("send","event",{eventCategory:"Menu",eventAction:"SortBy",eventLabel:t})}),$(document).on("submit","form",function(e){e.preventDefault(),ga("send","event",{eventCategory:"Social",eventAction:"Share",eventLabel:"EmailSubmit"});var t=$("#g-recaptcha-response").val();if(""===t)return void $(".form__response").slideDown().text("Please click the checkbox above.").delay(3e3).slideUp();var n=$(this),o=n.attr("action"),a=n.serialize();$("input[type=submit]").attr("disabled","disabled"),c(),$(".spinner").fadeIn(),$.ajax({type:"POST",url:o,data:a,success:function(e){"ok"===e.status&&$("form")[0].reset(),$("input[type=submit]").removeAttr("disabled"),$(".form__response").slideDown().text(e.message).delay(3e3).slideUp(),$(".spinner").hide(),ga("send","event",{eventCategory:"Social",eventAction:"Share",eventLabel:"EmailSent"})},error:function(){ga("send","event",{eventCategory:"Error",eventAction:"CaptchaError"})}})}),$(".menu--main").on("click",function(){$(this).toggleClass("menu--open"),$(".header--main, .copy--main, .share--header").toggleClass("menu--open"),ga("send","event",{eventCategory:"Menu",eventAction:"Open",eventLabel:"Mobile"})});var k;$(window).resize(function(){clearTimeout(k),k=setTimeout(d,150)}),d()});