"use strict";var modal=function($,e,t,n){function a(){s.fadeIn(250),$("body").addClass("modal--open")}function o(){s.fadeOut(250,function(){c.html("")}),$("body").removeClass("modal--open")}function i(e,t){return"video"===e.post_type&&(e.youtube_id=l(e.youtube_link)),e.download=t,d&&(e.download=!1),e}function l(e){var t=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,n=e.match(t);return n&&11==n[2].length?n[2]:void 0}function r(t){t=parseInt(t);var a=e(n).find(function(e){return e.ID===t});return a?a:default_post}var s={},c={},u,d="undefined"!=typeof InstallTrigger;return t.registerPartial("socialFooterModal",'<div class="social"><ul class="share share--tile" data-bitly={{bitly}}><span class="share__count" id="share{{ID}}">{{popularity}}</span><li class="share__item"><a class="icon icon--facebook" href="{{permalink}}">share on Facebook</a></li><li class="share__item"><a class="icon icon--twitter" href="{{permalink}}">share on Twitter</a></li><li class="share__item"><a class="icon icon--email" href="">Share via Email</a></li></ul></div>'),t.registerPartial("downloadFirefox",'<div class="choose"><p>Lorem ipsum dolor sit amet, consectetur adipiselit. Duis quis sodales diam. Pellentes supit dui vitae dolor dapibus luctus.</p><a href="http://firefox.com/download/?utm_source=foxyeahsite&utm_medium=referral&utm_content={{post_name}}&utm_campaign=sc-2015-foxyeah" class="button button--white">Choose Firefox</a></div>'),t.registerHelper("if_eq",function(e,t,n){return e==t?n.fn(this):n.inverse(this)}),{init:function(){s=$(".modal"),c=$(".modal__inner");var e=$("#email-template-new").html(),n=$("#modal-template-new").html();u={email:t.compile(e),modal:t.compile(n)}},open:function(e,t){var n=r(e);if("image"===n.post_type||"video"===n.post_type){var l=u.modal(i(n,t));c.html(l),a(),ga("send","event",{eventCategory:"Modal",eventAction:"Open",eventLabel:n.post_name}),$(".icon--close").on("click",function(){o(),ga("send","event",{eventCategory:"Modal",eventAction:"Close",eventValue:n.post_title})})}if(t){console.log("redirect = true");var s="unavailable";document.referrer&&(s=document.referrer),ga("send","event",{eventCategory:"Referrer",eventAction:"ModalOpen",eventLabel:s,eventValue:n.post_title})}},openLegal:function(e){c.html(e),a(),ga("send","event",{eventCategory:"Modal",eventAction:"Open",eventLabel:"Legal"}),$(".icon--close").on("click",function(){o(),ga("send","event",{eventCategory:"Modal",eventAction:"Close",eventValue:"Legal"})})},email:function(t){var n=u.email(i(r(t),redirect)),l=$.Deferred();e.isEmpty($.trim(c.html()))?l.resolve():c.fadeOut(250,function(){l.resolve()}),$.when(l).done(function(){c.html(n).fadeIn(250,function(){a(),$(".icon--close").on("click",function(){o()}),$(".button--cancel").on("click",function(e){e.preventDefault(),o()}),grecaptcha.render("grecaptcha",{sitekey:"6LetEQcTAAAAAFFmXLS-nvamIHuUFT3rubGqAb5m",callback:function(){}})})})},close:function(){o()}}}($,_,Handlebars,all_posts);